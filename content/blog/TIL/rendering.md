웹 페이지가 렌더링 되는 과정. DOM, CSSOM



HTML은 웹에서 정보를 쉽게 보여주기 위해서 구조화한 언어이다. 이러한 언어를 마크업(markup)이라고 한다.

### DOM

브라우저의 요청을 받은 서버는 사전에 작성되어 서버에 보관 중인 HTML 문서를 응답한다. HTML은 텍스트로 작성되어 있는 문서다. 이 문서를 시각적인 픽셀로 화면에 그려주려면(렌더링), 이 텍스트를 '브라우저가 이해할 수 있는 자료구조' 즉, **객체**로 변환해야 한다.

그것이 바로 **DOM (Document Objecet Model)**이다. DOM은 HTML 문서가 렌더링 엔진에 의해 파싱되어 생성된 노드들로 구성된 트리 자료구조인 것이다.

> 1. 브라우저가 서버에 요청을 보낸다.
> 2. 서버는 브라우저가 요청을 보낸 HTML 파일을 읽어 들여 메모리에 저장한 다음, 메모리에 저장된 바이트(2진수)를 응답한다.
> 3. 응답된 2진수 형태의 HTML 문서는 meta 태그의 charset 어트리뷰트에 의해 지정된 인코딩 방식(UTF-8)을 기준으로 브라우저가 문자열로 변환한다. 이때 meta 태그의 인코딩 방식은 응답 header의 ```content-type```에 담겨 전달된다.
> 4. 브라우저는 문자열을 읽으며 문법적 의미를 갖는 최소 단위인 토큰들로 분해한다. 그리고 각 토큰을 객체로 변환하여 노드들을 생성한다. (document node, text node, element node, attribute node)
> 5. 중첩 관계를 갖는 HTML 요소들에 의해 부자 관계가 반영된 노드들이 트리 자료구조로 구성된다. 그것이 바로 DOM!



### CSSOM

렌더링 엔진은 HTML을 파싱하며 DOM을 생성해 나가다가, CSS를 로드하는 ```<link>``` 태그나 ```<style>``` 태그를 만나면 DOM 생성을 일시 중단한다. 해당 태그에 지정된 CSS 파일을 서버에게 요청하여 **CSSOM (CSS Object Model)**을 생성한다. CSSOM은 DOM과 동일한 과정을 거쳐 생성되는데, 생성이 모두 완료되면 다시 중단된 지점에서부터 HTML을 파싱하며 DOM을 생성하게되는 것이다. CSSOM은 CSS의 '상속'을 반영하여 생성된다.



### Javascript

브라우저의 렌더링 엔진은 HTML 문서를 파싱해 나가다가 ```<script>``` 태그를 만나도, DOM 생성을 일시 중단한다. \<script> 태그에 정의된 자바스크립트 파일을 서버로부터 로드하면 자바스크립트를 파싱하기 위해 ```자바스크립트 엔진```에 제어권을 넘긴다. 자바스크립트 엔진은 자바스크립트 코드를 CPU가 이해할 수 있는 low-level-language로 변환하고 실행하는 역할을 담당한다.